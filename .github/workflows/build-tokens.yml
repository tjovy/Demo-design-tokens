name: ğŸ­ Build Tokens (JSON -> CSS)

on:
  push:
    branches: [main]
    paths: ['tokens.json'] # Ne se dÃ©clenche QUE si le design change

permissions:
  contents: write

jobs:
  build-css:
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ“¥ RÃ©cupÃ©rer le code
        uses: actions/checkout@v4

      - name: ğŸŸ¢ Installer Node
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: ğŸ“¦ Installer Style Dictionary
        run: npm install style-dictionary token-transformer

      - name: ğŸ”¨ Transformer & GÃ©nÃ©rer le CSS
        run: |
          npx token-transformer tokens.json tokens-fixed.json
          npx style-dictionary build --config config.json
          
      - name: ğŸ’¾ Commit du CSS gÃ©nÃ©rÃ©
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: "chore(design-tokens): ğŸ¤– GÃ©nÃ©ration automatique de build/css/variables.css"
          file_pattern: 'build/css/variables.css tokens-fixed.json'